[
  {
      "id": "ca49d97b508754c7",
      "type": "tab",
      "label": "IoT-Sensor-Data-Processing-NodeRED",
      "disabled": false,
      "info": "",
      "env": []
  },
  {
      "id": "47aa01e907a599ea",
      "type": "mqtt in",
      "z": "ca49d97b508754c7",
      "name": "",
      "topic": "team/sensors",
      "qos": "0",
      "datatype": "auto-detect",
      "broker": "37464be6e8cb6157",
      "nl": false,
      "rap": true,
      "rh": 0,
      "inputs": 0,
      "x": 90,
      "y": 220,
      "wires": [
          [
              "51f74d22d63a78e1"
          ]
      ]
  },
  {
      "id": "51f74d22d63a78e1",
      "type": "function",
      "z": "ca49d97b508754c7",
      "name": "Cold Path",
      "func": "var sensorData = msg.payload; // Ensure msg.payload is JSON parsed object\n\n// Initialize context.headersWritten if it doesn't exist\ncontext.headersWritten = context.headersWritten || {};\n\nswitch(sensorData.sensor_type) {\n    case 'position':\n        msg.filename = '/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/gps_data.csv';\n        if (!context.headersWritten.gps) {\n            msg.payload = `timestamp,sensor_id,latitude,longitude,altitude\\n${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.latitude},${sensorData.data.longitude},${sensorData.data.altitude}`;\n            context.headersWritten.gps = true;\n        } else {\n            msg.payload = `${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.latitude},${sensorData.data.longitude},${sensorData.data.altitude}`;\n        }\n        break;\n    case 'acceleration':\n        msg.filename = '/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/accel_data.csv';\n        if (!context.headersWritten.acceleration) {\n            msg.payload = `timestamp,sensor_id,x,y,z\\n${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.x},${sensorData.data.y},${sensorData.data.z}`;\n            context.headersWritten.acceleration = true;\n        } else {\n            msg.payload = `${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.x},${sensorData.data.y},${sensorData.data.z}`;\n        }\n        break;\n    case 'speed':\n        msg.filename = '/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/speed_data.csv';\n        if (!context.headersWritten.speed) {\n            msg.payload = `timestamp,sensor_id,speed\\n${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.speed}`;\n            context.headersWritten.speed = true;\n        } else {\n            msg.payload = `${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.speed}`;\n        }\n        break;\n    case 'vital_parameters':\n        msg.filename = '/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/vital_data.csv';\n        if (!context.headersWritten.vital_parameters) {\n            msg.payload = `timestamp,sensor_id,heart_rate,body_temperature\\n${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.heart_rate},${sensorData.data.body_temperature}`;\n            context.headersWritten.vital_parameters = true;\n        } else {\n            msg.payload = `${sensorData.timestamp},${sensorData.sensor_id},${sensorData.data.heart_rate},${sensorData.data.body_temperature}`;\n        }\n        break;\n    default:\n        return null; // Ignore unknown sensor types\n}\n\nreturn msg;\n",
      "outputs": 1,
      "timeout": 0,
      "noerr": 0,
      "initialize": "",
      "finalize": "",
      "libs": [],
      "x": 300,
      "y": 220,
      "wires": [
          [
              "af225e0dcccf5096"
          ]
      ]
  },
  {
      "id": "af225e0dcccf5096",
      "type": "file",
      "z": "ca49d97b508754c7",
      "name": "",
      "filename": "filename",
      "filenameType": "msg",
      "appendNewline": true,
      "createDir": false,
      "overwriteFile": "false",
      "encoding": "utf8",
      "x": 560,
      "y": 220,
      "wires": [
          []
      ]
  },
  {
      "id": "9af9a580c406e70f",
      "type": "file in",
      "z": "ca49d97b508754c7",
      "name": "read acceleration",
      "filename": "/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/accel_data.csv",
      "filenameType": "str",
      "format": "lines",
      "chunk": false,
      "sendError": false,
      "encoding": "utf8",
      "allProps": false,
      "x": 1050,
      "y": 80,
      "wires": [
          [
              "bcfed126d10a792b"
          ]
      ]
  },
  {
      "id": "bcfed126d10a792b",
      "type": "debug",
      "z": "ca49d97b508754c7",
      "name": "debug 2",
      "active": true,
      "tosidebar": true,
      "console": false,
      "tostatus": false,
      "complete": "true",
      "targetType": "full",
      "statusVal": "",
      "statusType": "auto",
      "x": 1350,
      "y": 80,
      "wires": []
  },
  {
      "id": "1c6e1cbd72b836f2",
      "type": "file in",
      "z": "ca49d97b508754c7",
      "name": "read speed",
      "filename": "/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/speed_data.csv",
      "filenameType": "str",
      "format": "utf8",
      "chunk": false,
      "sendError": false,
      "encoding": "utf8",
      "allProps": false,
      "x": 1030,
      "y": 220,
      "wires": [
          [
              "b8a763e2b1498fe8"
          ]
      ]
  },
  {
      "id": "b8a763e2b1498fe8",
      "type": "debug",
      "z": "ca49d97b508754c7",
      "name": "debug 3",
      "active": true,
      "tosidebar": true,
      "console": false,
      "tostatus": false,
      "complete": "payload",
      "targetType": "msg",
      "statusVal": "",
      "statusType": "auto",
      "x": 1280,
      "y": 220,
      "wires": []
  },
  {
      "id": "f42c9c74c332be4c",
      "type": "inject",
      "z": "ca49d97b508754c7",
      "name": "",
      "props": [
          {
              "p": "payload"
          },
          {
              "p": "topic",
              "vt": "str"
          }
      ],
      "repeat": "",
      "crontab": "",
      "once": false,
      "onceDelay": 0.1,
      "topic": "",
      "payload": "",
      "payloadType": "date",
      "x": 790,
      "y": 220,
      "wires": [
          [
              "1c6e1cbd72b836f2"
          ]
      ]
  },
  {
      "id": "06ef1183c42cf596",
      "type": "file in",
      "z": "ca49d97b508754c7",
      "name": "read GPS",
      "filename": "/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/gps_data.csv",
      "filenameType": "str",
      "format": "lines",
      "chunk": false,
      "sendError": false,
      "encoding": "utf8",
      "allProps": false,
      "x": 1020,
      "y": 300,
      "wires": [
          [
              "bc13eb1b6ef31889"
          ]
      ]
  },
  {
      "id": "b5948bfad23ec8bc",
      "type": "file in",
      "z": "ca49d97b508754c7",
      "name": "read vital data",
      "filename": "/home/musse/Documents/Class/IOT/Final Project/IoT-Sensor-Data-Processing-NodeRED/batch/vital_data.csv",
      "filenameType": "str",
      "format": "lines",
      "chunk": false,
      "sendError": false,
      "encoding": "utf8",
      "allProps": false,
      "x": 1060,
      "y": 400,
      "wires": [
          [
              "7b273d511b51760d"
          ]
      ]
  },
  {
      "id": "cb4c6bc77392d309",
      "type": "inject",
      "z": "ca49d97b508754c7",
      "name": "",
      "props": [
          {
              "p": "payload"
          },
          {
              "p": "topic",
              "vt": "str"
          }
      ],
      "repeat": "",
      "crontab": "",
      "once": false,
      "onceDelay": 0.1,
      "topic": "",
      "payload": "",
      "payloadType": "date",
      "x": 790,
      "y": 80,
      "wires": [
          [
              "9af9a580c406e70f"
          ]
      ]
  },
  {
      "id": "79f85fc2417a2000",
      "type": "inject",
      "z": "ca49d97b508754c7",
      "name": "",
      "props": [
          {
              "p": "payload"
          },
          {
              "p": "topic",
              "vt": "str"
          }
      ],
      "repeat": "",
      "crontab": "",
      "once": false,
      "onceDelay": 0.1,
      "topic": "",
      "payload": "",
      "payloadType": "date",
      "x": 790,
      "y": 300,
      "wires": [
          [
              "06ef1183c42cf596"
          ]
      ]
  },
  {
      "id": "57f253d9989d06ae",
      "type": "inject",
      "z": "ca49d97b508754c7",
      "name": "",
      "props": [
          {
              "p": "payload"
          },
          {
              "p": "topic",
              "vt": "str"
          }
      ],
      "repeat": "",
      "crontab": "",
      "once": false,
      "onceDelay": 0.1,
      "topic": "",
      "payload": "",
      "payloadType": "date",
      "x": 790,
      "y": 400,
      "wires": [
          [
              "b5948bfad23ec8bc"
          ]
      ]
  },
  {
      "id": "bc13eb1b6ef31889",
      "type": "debug",
      "z": "ca49d97b508754c7",
      "name": "debug 4",
      "active": true,
      "tosidebar": true,
      "console": false,
      "tostatus": false,
      "complete": "payload",
      "targetType": "msg",
      "statusVal": "",
      "statusType": "auto",
      "x": 1260,
      "y": 300,
      "wires": []
  },
  {
      "id": "7b273d511b51760d",
      "type": "debug",
      "z": "ca49d97b508754c7",
      "name": "debug 5",
      "active": true,
      "tosidebar": true,
      "console": false,
      "tostatus": false,
      "complete": "payload",
      "targetType": "msg",
      "statusVal": "",
      "statusType": "auto",
      "x": 1340,
      "y": 400,
      "wires": []
  },
  {
      "id": "37464be6e8cb6157",
      "type": "mqtt-broker",
      "name": "",
      "broker": "localhost",
      "port": "1883",
      "clientid": "",
      "autoConnect": true,
      "usetls": false,
      "protocolVersion": "4",
      "keepalive": "60",
      "cleansession": true,
      "autoUnsubscribe": true,
      "birthTopic": "",
      "birthQos": "0",
      "birthRetain": "false",
      "birthPayload": "",
      "birthMsg": {},
      "closeTopic": "",
      "closeQos": "0",
      "closeRetain": "false",
      "closePayload": "",
      "closeMsg": {},
      "willTopic": "",
      "willQos": "0",
      "willRetain": "false",
      "willPayload": "",
      "willMsg": {},
      "userProps": "",
      "sessionExpiry": ""
  }
]